(()=>{var a={};a.id=746,a.ids=[746],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14985:a=>{"use strict";a.exports=require("dns")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:a=>{"use strict";a.exports=require("os")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30211:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>K,patchFetch:()=>J,routeModule:()=>F,serverHooks:()=>I,workAsyncStorage:()=>G,workUnitAsyncStorage:()=>H});var d,e={};c.r(e),c.d(e,{POST:()=>E});var f=c(95736),g=c(9117),h=c(4044),i=c(39326),j=c(32324),k=c(261),l=c(54290),m=c(85328),n=c(38928),o=c(46595),p=c(3421),q=c(17679),r=c(41681),s=c(63446),t=c(86439),u=c(51356),v=c(10641),w=c(52731),x=c(96505),y=c(60112);let z={VALIDATION_ERROR:"Invalid input provided",AUTHENTICATION_ERROR:"Authentication required",AUTHORIZATION_ERROR:"Access denied",NOT_FOUND_ERROR:"Resource not found",RATE_LIMIT_ERROR:"Too many requests",CSRF_ERROR:"Security validation failed",INTERNAL_ERROR:"An internal error occurred",EXTERNAL_SERVICE_ERROR:"External service unavailable"},A={VALIDATION_ERROR:400,AUTHENTICATION_ERROR:401,AUTHORIZATION_ERROR:403,NOT_FOUND_ERROR:404,RATE_LIMIT_ERROR:429,CSRF_ERROR:403,INTERNAL_ERROR:500,EXTERNAL_SERVICE_ERROR:503};function B(a){let{type:b,message:c,details:d,originalError:e}=a;e&&console.error(`Error type ${b}: ${e.name}`);let f=c||z[b],g=A[b],h=v.NextResponse.json({error:f},{status:g});return(0,y.Gm)(h)}function C(a,b){return B({type:"VALIDATION_ERROR",details:a,originalError:b})}function D(a,b){return B({type:"RATE_LIMIT_ERROR",message:a,originalError:b})}let E=(d=async a=>{let b=(0,y.Tf)(a),c=(0,y.Eb)(`contact:${b}`,y.cr.CONTACT.maxRequests,y.cr.CONTACT.windowMs,y.cr.CONTACT.blockDurationMs);if(!c.allowed)return D(c.blocked?`Too many requests. IP blocked until ${new Date(c.resetTime).toISOString()}`:"Too many requests. Please try again later.");let d=await a.json(),e=(0,x.bG)(x.BM,d);if(!e.success)return C(e.errors);let{name:f,email:g,message:h}=e.data;if(console.log("SMTP Config Check:",{host:!!process.env.SMTP_HOST,user:!!process.env.SMTP_USER,pass:!!process.env.SMTP_PASS,port:process.env.SMTP_PORT}),process.env.SMTP_HOST&&process.env.SMTP_USER&&process.env.SMTP_PASS){console.log("Attempting to send email...");try{let a=w.createTransport({host:process.env.SMTP_HOST,port:parseInt(process.env.SMTP_PORT||"587"),secure:"true"===process.env.SMTP_SECURE,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}});await a.sendMail({from:"jbinverters@gmail.com",to:"jbinverters@gmail.com",subject:`New Contact Form Message from ${(0,x.ZD)(f)}`,html:`
          <h2>New Contact Form Message</h2>
          <p><strong>Name:</strong> ${(0,x.ZD)(f)}</p>
          <p><strong>Email:</strong> ${(0,x.ZD)(g)}</p>
          <p><strong>Message:</strong></p>
          <p>${(0,x.ZD)(h).replace(/\n/g,"<br>")}</p>
          <hr>
          <p><small>This message was sent from the JB Inverters contact form.</small></p>
          <p><strong>Reply to:</strong> ${(0,x.ZD)(g)}</p>
        `,replyTo:g}),console.log("Contact form email sent successfully")}catch(a){console.error("Error sending contact form email:",a)}}else console.log("SMTP not configured, skipping email notification");let i=v.NextResponse.json({success:!0});return(0,y.Gm)(i)},async(...a)=>{try{return await d(...a)}catch(a){if(console.error("Unhandled error in API route:",a),a instanceof Error){if(a.message.includes("validation")||a.message.includes("invalid"))return C(void 0,a);if(a.message.includes("unauthorized")||a.message.includes("authentication"))return B({type:"AUTHENTICATION_ERROR",message:void 0,originalError:a});if(a.message.includes("forbidden")||a.message.includes("authorization"))return B({type:"AUTHORIZATION_ERROR",message:void 0,originalError:a});if(a.message.includes("not found"))return B({type:"NOT_FOUND_ERROR",message:void 0,originalError:a});if(a.message.includes("rate limit")||a.message.includes("too many"))return D(void 0,a);if(a.message.includes("csrf")||a.message.includes("security"))return B({type:"CSRF_ERROR",message:void 0,originalError:a});if(a.message.includes("external")||a.message.includes("service"))return B({type:"EXTERNAL_SERVICE_ERROR",message:void 0,originalError:a})}return B({type:"INTERNAL_ERROR",message:void 0,originalError:a})}}),F=new f.AppRouteRouteModule({definition:{kind:g.RouteKind.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/var/www/jbinverters/src/app/api/contact/route.ts",nextConfigOutput:"",userland:e}),{workAsyncStorage:G,workUnitAsyncStorage:H,serverHooks:I}=F;function J(){return(0,h.patchFetch)({workAsyncStorage:G,workUnitAsyncStorage:H})}async function K(a,b,c){var d;let e="/api/contact/route";"/index"===e&&(e="/");let f=await F.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!f)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:h,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=f,D=(0,k.normalizeAppPath)(e),E=!!(y.dynamicRoutes[D]||y.routes[C]);if(E&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[D];if(b&&!1===b.fallback&&!a)throw new t.NoFallbackError}let G=null;!E||F.isDev||x||(G="/index"===(G=C)?"/":G);let H=!0===F.isDev||!E,I=E&&!H,J=a.method||"GET",K=(0,j.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,i.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>F.onRequestError(a,b,d,z)},sharedContext:{buildId:h}},N=new l.NodeNextRequest(a),O=new l.NodeNextResponse(b),P=m.NextRequestAdapter.fromNodeNextRequest(N,(0,m.signalFromNodeResponse)(b));try{let d=async c=>F.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==n.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),f=async f=>{var h,j;let k=async({previousCacheEntry:g})=>{try{if(!(0,i.getRequestMeta)(a,"minimalMode")&&A&&B&&!g)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(f);a.fetchMetrics=M.renderOpts.fetchMetrics;let h=M.renderOpts.pendingWaitUntil;h&&c.waitUntil&&(c.waitUntil(h),h=void 0);let j=M.renderOpts.collectedTags;if(!E)return await (0,p.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,q.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[s.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=s.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=s.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:u.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==g?void 0:g.isStale)&&await F.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,o.c)({isRevalidate:I,isOnDemandRevalidate:A})},z),b}},l=await F.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:g.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!E)return null;if((null==l||null==(h=l.value)?void 0:h.kind)!==u.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,i.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,q.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,i.getRequestMeta)(a,"minimalMode")&&E||m.delete(s.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,r.getCacheControlHeader)(l.cacheControl)),await (0,p.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await f(L):await K.withPropagatedContext(a.headers,()=>K.trace(n.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:j.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},f))}catch(b){if(b instanceof t.NoFallbackError||await F.onRequestError(a,b,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,o.c)({isRevalidate:I,isOnDemandRevalidate:A})}),E)throw b;return await (0,p.I)(N,O,new Response(null,{status:500})),null}}},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},60112:(a,b,c)=>{"use strict";c.d(b,{Eb:()=>i,Gm:()=>e,Tf:()=>k,cr:()=>j,v$:()=>g});var d=c(55511);function e(a){return a.headers.set("X-Content-Type-Options","nosniff"),a.headers.set("X-Frame-Options","DENY"),a.headers.set("X-XSS-Protection","1; mode=block"),a.headers.set("Content-Security-Policy","default-src 'self'"),a.headers.set("Referrer-Policy","strict-origin-when-cross-origin"),a}let f=process.env.CSRF_SECRET||"default-csrf-secret-change-in-production";function g(){let a=(0,d.randomBytes)(32).toString("hex"),b=Date.now().toString(),c=(0,d.createHmac)("sha256",f).update(a+b).digest("hex");return`${a}:${b}:${c}`}let h=new Map;function i(a,b=10,c=6e4,d=9e5){let e=Date.now(),f=h.get(a);return f?.blocked&&f.blockUntil&&e<f.blockUntil?{allowed:!1,remaining:0,resetTime:f.blockUntil,blocked:!0}:(f?.blocked&&f.blockUntil&&e>=f.blockUntil&&(f.blocked=!1,f.blockUntil=void 0),!f||e>f.resetTime)?(h.set(a,{count:1,resetTime:e+c,blocked:!1}),{allowed:!0,remaining:b-1,resetTime:e+c,blocked:!1}):f.count>=b?(f.blocked=!0,f.blockUntil=e+d,h.set(a,f),{allowed:!1,remaining:0,resetTime:f.blockUntil,blocked:!0}):(f.count++,h.set(a,f),{allowed:!0,remaining:b-f.count,resetTime:f.resetTime,blocked:!1})}setInterval(()=>{let a=Date.now();for(let[b,c]of h.entries())a>c.resetTime&&(!c.blockUntil||a>c.blockUntil)&&h.delete(b)},3e5);let j={CONTACT:{maxRequests:5,windowMs:6e4,blockDurationMs:9e5},ORDER:{maxRequests:3,windowMs:6e4,blockDurationMs:18e5},LOGIN:{maxRequests:5,windowMs:9e5,blockDurationMs:36e5},UPLOAD:{maxRequests:10,windowMs:6e4,blockDurationMs:6e5},API_GENERAL:{maxRequests:100,windowMs:6e4,blockDurationMs:3e5}};function k(a){let b=a.headers.get("x-forwarded-for"),c=a.headers.get("x-real-ip"),d=a.headers.get("cf-connecting-ip");return d||c||(b?b.split(",")[0].trim():"unknown")}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:a=>{"use strict";a.exports=require("zlib")},78335:()=>{},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},81630:a=>{"use strict";a.exports=require("http")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")},96487:()=>{},96505:(a,b,c)=>{"use strict";c.d(b,{BM:()=>f,HU:()=>g,Ko:()=>i,ZD:()=>e,bG:()=>j});var d=c(59507);function e(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#x2F;")}let f=d.Ikc({name:d.YjP().min(1,"Name is required").max(100,"Name must be less than 100 characters").regex(/^[a-zA-Z\s\-'\.]+$/,"Name contains invalid characters").refine(a=>!/<script|javascript:|vbscript:/i.test(a),"Name contains potentially malicious content"),email:d.YjP().min(1,"Email is required").email("Invalid email format").max(255,"Email must be less than 255 characters").refine(a=>!/<script|javascript:|vbscript:/i.test(a),"Email contains potentially malicious content"),message:d.YjP().min(1,"Message is required").max(2e3,"Message must be less than 2000 characters").refine(a=>!/<script|javascript:|vbscript:|onload=|onerror=/i.test(a),"Message contains potentially malicious content")}),g=d.Ikc({name:d.YjP().min(1,"Product name is required").max(255,"Product name must be less than 255 characters").refine(a=>!/<script|javascript:|vbscript:/i.test(a),"Product name contains potentially malicious content"),description:d.YjP().max(1e3,"Description must be less than 1000 characters").refine(a=>!a||!/<script|javascript:|vbscript:/i.test(a),"Description contains potentially malicious content").optional(),price:d.aig().positive("Price must be positive").max(999999.99,"Price too high").refine(a=>!isNaN(a)&&isFinite(a),"Price must be a valid number"),imageUrl:d.YjP().max(500,"Image URL too long").optional().refine(a=>{if(!a)return!0;let b=a.startsWith("/")||a.startsWith("http://")||a.startsWith("https://"),c=!/<script|javascript:|vbscript:/i.test(a);return b&&c},"Image URL must be a valid path or URL without malicious content"),stock:d.aig().int("Stock must be an integer").min(0,"Stock cannot be negative").max(99999,"Stock too high").refine(a=>!isNaN(a)&&isFinite(a),"Stock must be a valid number"),displayOrder:d.aig().int("Display order must be an integer").min(0,"Display order cannot be negative").max(9999,"Display order too high").refine(a=>!isNaN(a)&&isFinite(a),"Display order must be a valid number").default(0),isActive:d.zMY().default(!0)}),h=d.Ikc({id:d.YjP().min(1,"Product ID is required"),quantity:d.aig().int("Quantity must be an integer").min(1,"Quantity must be at least 1").max(999,"Quantity too high"),price:d.aig().positive("Price must be positive").max(999999.99,"Price too high")}),i=d.Ikc({customerName:d.YjP().max(255,"Customer name too long").optional(),customerEmail:d.YjP().email("Invalid email format").max(255,"Email too long").optional(),customerAddress:d.YjP().max(1e3,"Address too long").optional(),customerPhone:d.YjP().max(50,"Phone number too long").optional(),items:d.YOg(h).min(1,"At least one item is required").max(50,"Too many items"),total:d.aig().positive("Total must be positive").max(999999.99,"Total too high")});function j(a,b){try{let c=function a(b){if(null==b)return b;if("string"==typeof b){let a=b.replace(/\0/g,"").replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"").trim();for(let b of[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/vbscript:/gi,/onload=/gi,/onerror=/gi,/onclick=/gi,/onmouseover=/gi,/data:text\/html/gi,/expression\s*\(/gi])if(b.test(a))throw Error("Potentially malicious input detected");return a}if(Array.isArray(b))return b.map(a);if("object"==typeof b&&null!==b){let c={};for(let[d,e]of Object.entries(b)){if(!/^[a-zA-Z0-9_-]+$/.test(d))throw Error("Invalid object key detected");c[d]=a(e)}return c}return b}(b),d=a.parse(c);return{success:!0,data:d}}catch(a){if(a instanceof d.GaX)return{success:!1,errors:(a.issues||[]).map(a=>`${a.path.join(".")}: ${a.message}`)};if(a instanceof Error&&a.message.includes("malicious"))return{success:!1,errors:["Potentially malicious input detected"]};return console.error("Validation error:",a),{success:!1,errors:["Invalid input format"]}}}d.Ikc({serialNumbers:d.YOg(d.YjP()).min(1,"Serial numbers are required").max(100,"Too many serial numbers"),notes:d.YjP().max(500,"Notes too long").optional()})}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[996,692,507,112],()=>b(b.s=30211));module.exports=c})();