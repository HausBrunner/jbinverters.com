(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{1873:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>q});var r=s(5155),a=s(2115),l=s(6489),i=s(63),n=s(4926),d=s(6617),c=s(512),o=s(7828),x=s(3664),m=s(6191),u=s(2108),h=s(4033),p=s(7107),g=s(8629),b=s(1360),y=s(1375),f=s(6651),j=s(6955),N=s(6100),v=s(1047),w=s(9715),k=s(6398),S=s(5229),A=s(1786);function C(e){let{isOpen:t,onClose:s,onProductAdded:l}=e,[i,n]=(0,a.useState)({name:"",description:"",price:"",imageUrl:"",stock:"",isActive:!0}),[d,c]=(0,a.useState)(!1),[o,x]=(0,a.useState)(""),[u,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(null),b=async e=>{e.preventDefault(),c(!0),x("");try{let e=i.imageUrl;if(u){let t=new FormData;t.append("image",u);let s=await fetch("/api/admin/upload",{method:"POST",body:t});if(s.ok)e=(await s.json()).imageUrl;else throw Error("Failed to upload image")}if(!(await fetch("/api/admin/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,price:parseFloat(i.price),stock:parseInt(i.stock),displayOrder:0,imageUrl:e})})).ok)throw Error("Failed to create product");n({name:"",description:"",price:"",imageUrl:"",stock:"",isActive:!0}),h(null),g(null),l(),s()}catch(e){x("Failed to create product. Please try again.")}finally{c(!1)}},y=e=>{n(t=>({...t,[e.target.name]:e.target.value}))};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Product"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(S.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("form",{onSubmit:b,className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",required:!0,value:i.name,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:"Enter product name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{id:"description",name:"description",value:i.description,onChange:y,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:"Enter product description"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:"Price *"}),(0,r.jsx)("input",{type:"number",id:"price",name:"price",required:!0,step:"0.01",min:"0",value:i.price,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:"0.00"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock *"}),(0,r.jsx)("input",{type:"number",id:"stock",name:"stock",required:!0,min:"0",value:i.stock,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:"0"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Image"}),(0,r.jsxs)("div",{className:"space-y-2",children:[p&&(0,r.jsx)("div",{className:"w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:(0,r.jsx)("img",{src:p,alt:"Product preview",className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"file",id:"image",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){h(s);let e=new FileReader;e.onload=e=>{var t;g(null==(t=e.target)?void 0:t.result)},e.readAsDataURL(s)}},className:"hidden"}),(0,r.jsxs)("label",{htmlFor:"image",className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 cursor-pointer",children:[(0,r.jsx)(A.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"Upload Image"})]})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Upload an image file for the product"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:i.isActive,onChange:e=>{n(t=>({...t,[e.target.name]:e.target.checked}))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-700",children:"Active (visible to customers)"})]}),o&&(0,r.jsx)("div",{className:"text-red-600 text-sm",children:o}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[d?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,r.jsx)(m.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:d?"Creating...":"Create Product"})]})]})]})]})}):null}var E=s(3665);function O(e){let{isOpen:t,onClose:s,onProductUpdated:l,product:i}=e,[n,d]=(0,a.useState)({name:"",description:"",price:"",imageUrl:"",stock:"",displayOrder:"",isActive:!0}),[c,o]=(0,a.useState)(!1),[x,m]=(0,a.useState)(""),[u,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(null);(0,a.useEffect)(()=>{i&&(d({name:i.name,description:i.description||"",price:i.price.toString(),imageUrl:i.imageUrl||"",stock:i.stock.toString(),displayOrder:i.displayOrder.toString(),isActive:i.isActive}),g(i.imageUrl))},[i]);let b=async e=>{if(e.preventDefault(),i){o(!0),m("");try{let e=n.imageUrl;if(u){console.log("Starting image upload...");let t=new FormData;t.append("image",u);try{let s=new AbortController,r=setTimeout(()=>s.abort(),3e4),a=await fetch("/api/admin/upload",{method:"POST",body:t,signal:s.signal});if(clearTimeout(r),console.log("Upload response status:",a.status),a.ok)e=(await a.json()).imageUrl,console.log("Upload successful:",e);else{let e=await a.json();throw console.error("Upload failed:",e),Error(e.error||"Failed to upload image")}}catch(e){if(console.error("Upload error:",e),e instanceof Error&&"AbortError"===e.name)throw Error("Upload timed out. Please try again with a smaller image or check your connection.");throw Error("Upload failed: ".concat(e instanceof Error?e.message:"Unknown error"))}}if(!(await fetch("/api/admin/products/".concat(i.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,price:parseFloat(n.price),stock:parseInt(n.stock),displayOrder:parseInt(n.displayOrder)||0,imageUrl:e})})).ok)throw Error("Failed to update product");l(),s()}catch(e){m(e instanceof Error?e.message:"Failed to update product. Please try again.")}finally{o(!1)}}},y=e=>{d(t=>({...t,[e.target.name]:e.target.value}))};return t&&i?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Product"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(S.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("form",{onSubmit:b,className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",required:!0,value:n.name,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",placeholder:"Enter product name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{id:"description",name:"description",value:n.description,onChange:y,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",placeholder:"Enter product description"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:"Price *"}),(0,r.jsx)("input",{type:"number",id:"price",name:"price",required:!0,step:"0.01",min:"0",value:n.price,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",placeholder:"0.00"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock *"}),(0,r.jsx)("input",{type:"number",id:"stock",name:"stock",required:!0,min:"0",value:n.stock,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",placeholder:"0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"displayOrder",className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,r.jsx)("input",{type:"number",id:"displayOrder",name:"displayOrder",min:"0",value:n.displayOrder,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900",placeholder:"0"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Image"}),(0,r.jsxs)("div",{className:"space-y-2",children:[p&&(0,r.jsx)("div",{className:"w-full h-32 bg-gray-100 rounded-lg overflow-hidden",children:(0,r.jsx)("img",{src:p,alt:"Product preview",className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"file",id:"image",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){if(!s.type.startsWith("image/"))return void m("Please select an image file (JPG, PNG, GIF, etc.)");if(s.size>0xa00000)return void m("Image file must be less than 10MB");m(""),h(s);let e=new FileReader;e.onload=e=>{var t;g(null==(t=e.target)?void 0:t.result)},e.readAsDataURL(s)}},className:"hidden"}),(0,r.jsxs)("label",{htmlFor:"image",className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 cursor-pointer",children:[(0,r.jsx)(A.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:p?"Change Image":"Upload Image"})]})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Upload an image file for the product"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isActive",name:"isActive",checked:n.isActive,onChange:e=>{d(t=>({...t,[e.target.name]:e.target.checked}))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,r.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-gray-700",children:"Active (visible to customers)"})]}),x&&(0,r.jsx)("div",{className:"text-red-600 text-sm",children:x}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),(0,r.jsxs)("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[c?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,r.jsx)(E.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:c?"Updating...":"Update Product"})]})]})]})]})}):null}var P=s(5917);let D=[{value:"ORDER_RECEIVED",label:"Order Received",color:"bg-gray-100 text-gray-800"},{value:"PAID_PENDING_SHIPMENT",label:"Payment Received and Order Pending",color:"bg-blue-100 text-blue-800"},{value:"SHIPPED_AND_COMPLETE",label:"Shipped & Complete",color:"bg-green-100 text-green-800"},{value:"CANCELLED",label:"Cancel Order",color:"bg-red-100 text-red-800"}],L=[{value:"ORDER_RECEIVED",label:"Order Received",color:"bg-gray-100 text-gray-800"},{value:"PAID",label:"Payment Received",color:"bg-blue-100 text-blue-800"},{value:"RECEIVED",label:"Device Received",color:"bg-orange-100 text-orange-800"},{value:"QUOTE_SENT",label:"Diagnostic Complete and Quote Sent",color:"bg-pink-100 text-pink-800"},{value:"REPAIRING",label:"Repairing",color:"bg-purple-100 text-purple-800"},{value:"SHIPPED_AND_COMPLETE",label:"Shipped & Complete",color:"bg-green-100 text-green-800"},{value:"CANCELLED",label:"Cancel Order",color:"bg-red-100 text-red-800"}];function I(e){var t,s;let{order:l,onStatusUpdate:i}=e,[n,d]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),p=(null==(t=l.items)?void 0:t.some(e=>"mail-in-service"===e.product.id))?L:D,g=p.find(e=>e.value===l.status),b=async e=>{if(e===l.status)return void d(!1);o(!0);try{(await fetch("/api/admin/orders/".concat(l.id,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e,sendEmail:!1})})).ok?(i(),d(!1),u(null)):alert("Failed to update order status")}catch(e){alert("Error updating order status")}finally{o(!1)}},y=async e=>{if(e===l.status)return void d(!1);if(!l.customerEmail)return void alert("No customer email available for this order");o(!0);try{(await fetch("/api/admin/orders/".concat(l.id,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e,sendEmail:!0})})).ok?(i(),d(!1),u(null)):alert("Failed to update order status")}catch(e){alert("Error updating order status")}finally{o(!1)}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>d(!n),disabled:c,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold ".concat(null==g?void 0:g.color," hover:opacity-80 disabled:opacity-50"),children:[c?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-1"}):(0,r.jsx)(h.A,{className:"w-3 h-3 mr-1"}),null==g?void 0:g.label]}),n&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:[(0,r.jsx)("div",{className:"py-1",children:m?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-50",children:["Change to: ",null==(s=p.find(e=>e.value===m))?void 0:s.label]}),(0,r.jsx)("button",{onClick:()=>b(m),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:"Update status only"}),l.customerEmail?(0,r.jsxs)("button",{onClick:()=>y(m),className:"w-full text-left px-4 py-2 text-sm text-blue-600 hover:bg-gray-100 flex items-center",children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Update + Email customer"]}):(0,r.jsx)("div",{className:"px-4 py-2 text-xs text-gray-500",children:"No customer email available"}),(0,r.jsx)("div",{className:"border-t border-gray-200 my-1"}),(0,r.jsx)("button",{onClick:()=>u(null),className:"w-full text-left px-4 py-2 text-sm text-gray-500 hover:bg-gray-100",children:"← Back to status list"})]}):(0,r.jsx)(r.Fragment,{children:p.map(e=>(0,r.jsxs)("button",{onClick:()=>{e.value!==l.status&&u(e.value)},disabled:e.value===l.status,className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center justify-between ".concat(e.value===l.status?"bg-gray-50 text-gray-400 cursor-default":"cursor-pointer text-gray-900"),children:[(0,r.jsx)("span",{children:e.label}),e.value===l.status&&(0,r.jsx)(P.A,{className:"w-4 h-4 text-green-600"})]},e.value))})}),(0,r.jsx)("div",{className:"border-t border-gray-200 py-1",children:(0,r.jsx)("button",{onClick:()=>{d(!1),u(null)},className:"w-full text-left px-4 py-2 text-sm text-gray-500 hover:bg-gray-100",children:"Cancel"})})]}),n&&(0,r.jsx)("div",{className:"fixed inset-0 z-0",onClick:()=>{d(!1),u(null)}})]})}var T=s(9867);let U=[{value:"AVAILABLE",label:"Available",color:"bg-green-100 text-green-800"},{value:"SOLD",label:"Sold",color:"bg-blue-100 text-blue-800"},{value:"RESERVED",label:"Reserved",color:"bg-yellow-100 text-yellow-800"},{value:"DEFECTIVE",label:"Defective",color:"bg-red-100 text-red-800"},{value:"RETURNED",label:"Returned",color:"bg-gray-100 text-gray-800"}];function R(e){let{isOpen:t,onClose:s,productId:l,productName:i}=e,[n,d]=(0,a.useState)([]),[c,o]=(0,a.useState)([]),[x,u]=(0,a.useState)(!1),[h,p]=(0,a.useState)(""),[y,N]=(0,a.useState)(""),[v,w]=(0,a.useState)(null),[k,A]=(0,a.useState)(""),[C,O]=(0,a.useState)("AVAILABLE"),[P,D]=(0,a.useState)(""),[L,I]=(0,a.useState)("ALL");(0,a.useEffect)(()=>{t&&l&&R()},[t,l]),(0,a.useEffect)(()=>{let e=n;P&&(e=e.filter(e=>e.serialNumber.toLowerCase().includes(P.toLowerCase())||e.notes&&e.notes.toLowerCase().includes(P.toLowerCase())||e.orderNumber&&e.orderNumber.toLowerCase().includes(P.toLowerCase()))),"ALL"!==L&&(e=e.filter(e=>e.status===L)),o(e)},[n,P,L]);let R=async()=>{u(!0);try{let e=await fetch("/api/admin/serial-numbers?productId=".concat(l));if(e.ok){let t=await e.json();d(t)}}catch(e){console.error("Error fetching serial numbers:",e)}finally{u(!1)}},F=async()=>{if(!h.trim())return;let e=h.split("\n").map(e=>e.trim()).filter(e=>e.length>0);if(0!==e.length){u(!0);try{let t=await fetch("/api/admin/serial-numbers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:l,serialNumbers:e,notes:y.trim()||null})});if(t.ok)p(""),N(""),R();else{let e=await t.json(),s=e.details||e.error||"Failed to add serial numbers";alert(s)}}catch(e){alert("Error adding serial numbers")}finally{u(!1)}}},_=async e=>{u(!0);try{let t=await fetch("/api/admin/serial-numbers/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:C,notes:k.trim()||null})});if(t.ok)w(null),R();else{let e=(await t.json()).error||"Failed to update serial number";alert(e)}}catch(e){alert("Error updating serial number")}finally{u(!1)}},q=async e=>{if(confirm("Are you sure you want to delete this serial number?")){u(!0);try{let t=await fetch("/api/admin/serial-numbers/".concat(e),{method:"DELETE"});if(t.ok)R();else{let e=(await t.json()).error||"Failed to delete serial number";alert(e)}}catch(e){alert("Error deleting serial number")}finally{u(!1)}}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Serial Numbers - ",i]}),(0,r.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(S.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Add New Serial Numbers"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Serial Numbers (one per line)"}),(0,r.jsx)("textarea",{value:h,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",rows:3,placeholder:"SN001"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),(0,r.jsx)("input",{type:"text",value:y,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:"Batch notes, supplier info, etc."})]}),(0,r.jsxs)("button",{onClick:F,disabled:x||!h.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700 disabled:opacity-50",children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Add Serial Numbers"})]})]})]}),(0,r.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search serial numbers, notes, or order numbers...",value:P,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j.A,{className:"text-gray-400 w-4 h-4"}),(0,r.jsxs)("select",{value:L,onChange:e=>I(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white",children:[(0,r.jsx)("option",{value:"ALL",children:"All Status"}),U.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,r.jsxs)("button",{onClick:()=>{let e=new Blob([[["Serial Number","Status","Order Number","Notes","Created Date"],...c.map(e=>[e.serialNumber,e.status,e.orderNumber||"",e.notes||"",new Date(e.createdAt).toLocaleDateString()])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="".concat(i,"_serial_numbers_").concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t)},className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-green-700",children:[(0,r.jsx)(T.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Export CSV"})]})]})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:["Serial Numbers (",c.length," of ",n.length,")"]}),x&&0===n.length?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"})}):0===n.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-700",children:"No serial numbers added yet"}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Serial Number"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Added"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(e=>{var t,s;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.serialNumber}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:v===e.id?(0,r.jsx)("select",{value:C,onChange:e=>O(e.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded text-gray-900 bg-white",children:U.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat((null==(t=U.find(t=>t.value===e.status))?void 0:t.color)||"bg-gray-100 text-gray-800"),children:(null==(s=U.find(t=>t.value===e.status))?void 0:s.label)||e.status})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.orderNumber?(0,r.jsx)("span",{className:"font-medium text-blue-600",children:e.orderNumber}):(0,r.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs",children:v===e.id?(0,r.jsx)("input",{type:"text",value:k,onChange:e=>A(e.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-gray-900",placeholder:"Add notes..."}):(0,r.jsx)("span",{className:"truncate block",title:e.notes||"",children:e.notes||"-"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:v===e.id?(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>_(e.id),disabled:x,className:"text-green-600 hover:text-green-900",children:(0,r.jsx)(E.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>w(null),className:"text-gray-600 hover:text-gray-900",children:(0,r.jsx)(S.A,{className:"w-4 h-4"})})]}):(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{w(e.id),A(e.notes||""),O(e.status)},className:"text-blue-600 hover:text-blue-900",children:(0,r.jsx)(g.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>q(e.id),className:"text-red-600 hover:text-red-900",children:(0,r.jsx)(b.A,{className:"w-4 h-4"})})]})})]},e.id)})})]})})]})]})]})}):null}function F(e){let{isOpen:t,onClose:s,orderId:l,orderNumber:i,productId:n,productName:d,quantity:c,onSerialNumbersAssigned:o}=e,[x,m]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[p,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)("");(0,a.useEffect)(()=>{t&&n&&j()},[t,n]);let j=async()=>{g(!0);try{let e=await fetch("/api/admin/serial-numbers?productId=".concat(n));if(e.ok){let t=(await e.json()).filter(e=>"AVAILABLE"===e.status);m(t)}}catch(e){console.error("Error fetching serial numbers:",e)}finally{g(!1)}},N=async()=>{if(0===u.length)return void alert("Please select at least one serial number");if(u.length>c)return void alert("You can only assign ".concat(c," serial numbers for this order"));g(!0);try{(await fetch("/api/admin/serial-numbers/assign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:l,serialNumberIds:u})})).ok?(o(),s()):alert("Failed to assign serial numbers")}catch(e){alert("Error assigning serial numbers")}finally{g(!1)}},v=x.filter(e=>e.serialNumber.toLowerCase().includes(b.toLowerCase())||e.notes&&e.notes.toLowerCase().includes(b.toLowerCase()));return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Assign Serial Numbers"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Order ",i," - ",d," (Quantity: ",c,")"]})]}),(0,r.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(S.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search serial numbers...",value:b,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900"})]})}),(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:["Selected: ",u.length," of ",c," required"]})}),p?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"})}):0===v.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-700",children:"No available serial numbers found"}):(0,r.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:v.map(e=>(0,r.jsx)("button",{onClick:()=>{var t;return t=e.id,void h(e=>e.includes(t)?e.filter(e=>e!==t):e.length<c?[...e,t]:e)},disabled:u.length>=c&&!u.includes(e.id),className:"w-full p-3 border rounded-lg transition-colors text-left ".concat(u.includes(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"," ").concat(u.length>=c&&!u.includes(e.id)?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-gray-50"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 rounded flex items-center justify-center ".concat(u.includes(e.id)?"border-blue-500 bg-blue-500":"border-gray-300"),children:u.includes(e.id)&&(0,r.jsx)(P.A,{className:"w-3 h-3 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.serialNumber}),e.notes&&(0,r.jsx)("p",{className:"text-sm text-gray-700",children:e.notes})]})]}),(0,r.jsx)("span",{className:"text-xs text-green-800 bg-green-100 px-2 py-1 rounded-full font-medium",children:"Available"})]})},e.id))})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,r.jsx)("button",{onClick:N,disabled:p||0===u.length||u.length>c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:p?"Assigning...":"Assign ".concat(u.length," Serial Number").concat(1!==u.length?"s":"")})]})]})}):null}class _ extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?this.props.fallback||(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[(0,r.jsx)("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),(0,r.jsx)("p",{className:"text-red-600 text-sm mt-1",children:"Please refresh the page or try disabling browser extensions."})]}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}function q(){var e;let{data:t,status:s}=(0,l.useSession)(),S=(0,i.useRouter)(),[A,E]=(0,a.useState)("overview"),[P,D]=(0,a.useState)([]),[L,T]=(0,a.useState)([]),[U,q]=(0,a.useState)(!0),[J,G]=(0,a.useState)(!1),[V,B]=(0,a.useState)(!1),[Q,M]=(0,a.useState)(null),[z,$]=(0,a.useState)(!1),[H,W]=(0,a.useState)(!1),[Y,K]=(0,a.useState)(null),[X,Z]=(0,a.useState)(""),[ee,et]=(0,a.useState)("ALL"),[es,er]=(0,a.useState)("createdAt"),[ea,el]=(0,a.useState)("desc"),[ei,en]=(0,a.useState)(!1),[ed,ec]=(0,a.useState)(null),[eo,ex]=(0,a.useState)(""),[em,eu]=(0,a.useState)(null),[eh,ep]=(0,a.useState)(""),[eg,eb]=(0,a.useState)(null),[ey,ef]=(0,a.useState)("");(0,a.useEffect)(()=>{"unauthenticated"===s?S.push("/admin/login"):"authenticated"===s&&ej()},[s,S]),(0,a.useEffect)(()=>{"authenticated"===s&&"orders"===A&&ej()},[X,ee,es,ea,ei,A]);let ej=async()=>{try{let e=new URLSearchParams;X&&e.append("search",X),"ALL"!==ee&&e.append("status",ee),es&&e.append("sortBy",es),ea&&e.append("sortOrder",ea),e.append("archived",ei.toString());let[t,s]=await Promise.all([fetch("/api/admin/products"),fetch("/api/admin/orders?".concat(e.toString()))]);if(t.ok){let e=await t.json();D(e)}if(s.ok){let e=await s.json();T(e)}}catch(e){console.error("Error fetching admin data:",e)}finally{q(!1)}},eN=async e=>{try{(await fetch("/api/admin/orders/".concat(e,"/notes"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:eo})})).ok?(ec(null),ex(""),ej()):alert("Failed to update order notes")}catch(e){alert("Error updating order notes")}},ev=async(e,t)=>{try{(await fetch("/api/admin/orders/".concat(e,"/archive"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isArchived:t})})).ok?ej():alert("Failed to ".concat(t?"archive":"unarchive"," order"))}catch(e){alert("Error ".concat(t?"archiving":"unarchiving"," order"))}},ew=async e=>{try{(await fetch("/api/admin/orders/".concat(e,"/tracking"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({trackingNumber:eh})})).ok?(eu(null),ep(""),ej()):alert("Failed to update tracking number")}catch(e){alert("Error updating tracking number")}},ek=async e=>{try{(await fetch("/api/admin/orders/".concat(e,"/repair-quote"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({repairQuote:ey})})).ok?(eb(null),ef(""),ej()):alert("Failed to save repair quote")}catch(e){alert("Error saving repair quote")}},eS=async e=>{if(confirm("Are you sure you want to delete this product?"))try{(await fetch("/api/admin/products/".concat(e),{method:"DELETE"})).ok?ej():alert("Failed to delete product")}catch(e){alert("Error deleting product")}},eA=async(e,t)=>{let s=P.find(t=>t.id===e);if(!s)return;let r=s.displayOrder,a="up"===t?r-1:r+1,l=P.find(e=>e.displayOrder===a);if(l)try{let[t,i]=await Promise.all([fetch("/api/admin/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,displayOrder:a})}),fetch("/api/admin/products/".concat(l.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...l,displayOrder:r})})]);t.ok&&i.ok?ej():alert("Failed to reorder products")}catch(e){console.error("Error reordering products:",e),alert("Error reordering products")}};if("loading"===s||U)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})});if(!t)return null;let eC={totalProducts:P.length,totalOrders:L.length,totalRevenue:L.reduce((e,t)=>e+t.total,0)};return(0,r.jsx)(_,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100","data-autofill":"disabled",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Welcome, ",null==(e=t.user)?void 0:e.email]})]}),(0,r.jsxs)("button",{onClick:()=>{(0,l.signOut)({callbackUrl:"/"})},className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[(0,r.jsx)(n.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Sign Out"})]})]})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(d.A,{className:"w-8 h-8 text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Products"}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eC.totalProducts})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(c.A,{className:"w-8 h-8 text-green-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Orders"}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:eC.totalOrders})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(c.A,{className:"w-8 h-8 text-purple-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Revenue"}),(0,r.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:["$",eC.totalRevenue.toFixed(2)]})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsx)("nav",{className:"-mb-px flex space-x-8 px-6",children:[{id:"overview",name:"Overview",icon:o.A},{id:"products",name:"Products",icon:d.A},{id:"orders",name:"Orders",icon:c.A},{id:"email-templates",name:"Email Templates",icon:x.A,isLink:!0}].map(e=>(0,r.jsxs)("button",{onClick:()=>e.isLink?S.push("/admin/".concat(e.id)):E(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ".concat(A===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,r.jsx)(e.icon,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:e.name})]},e.id))})}),(0,r.jsxs)("div",{className:"p-6",children:["overview"===A&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Activity"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Orders"}),(0,r.jsx)("div",{className:"space-y-3",children:L.slice(0,5).map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.orderNumber}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:e.customerName||"Guest"})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"font-medium text-gray-900",children:["$",e.total.toFixed(2)]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]})]},e.id))})]})]}),"products"===A&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Products"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"font-medium",children:"Sort Order:"})," Lower numbers appear first on main page"]}),(0,r.jsxs)("button",{onClick:()=>G(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700",children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Add Product"})]})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full divide-y divide-gray-200 table-fixed",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"w-16 px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),(0,r.jsx)("th",{className:"w-64 px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"w-20 px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,r.jsx)("th",{className:"w-16 px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),(0,r.jsx)("th",{className:"w-20 px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"w-24 px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-3 py-4 text-sm text-gray-900 text-center",children:e.displayOrder}),(0,r.jsx)("td",{className:"px-3 py-4",children:(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",title:e.name,children:e.name}),e.description&&(0,r.jsx)("div",{className:"text-xs text-gray-500 truncate mt-1",title:e.description,children:e.description})]})}),(0,r.jsxs)("td",{className:"px-3 py-4 text-sm text-gray-900 text-center",children:["$",e.price.toFixed(2)]}),(0,r.jsx)("td",{className:"px-3 py-4 text-sm text-gray-900 text-center",children:e.stock}),(0,r.jsx)("td",{className:"px-3 py-4 text-center",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"})}),(0,r.jsx)("td",{className:"px-3 py-4 text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex space-x-1 justify-center",children:[(0,r.jsx)("button",{onClick:()=>eA(e.id,"up"),className:"text-gray-600 hover:text-gray-900 p-1",title:"Move Up",disabled:1===e.displayOrder,children:(0,r.jsx)(u.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>eA(e.id,"down"),className:"text-gray-600 hover:text-gray-900 p-1",title:"Move Down",disabled:e.displayOrder===P.length,children:(0,r.jsx)(h.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>{M(e),$(!0)},className:"text-purple-600 hover:text-purple-900 p-1",title:"Manage Serial Numbers",children:(0,r.jsx)(p.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>{M(e),B(!0)},className:"text-blue-600 hover:text-blue-900 p-1",title:"Edit Product",children:(0,r.jsx)(g.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>eS(e.id),className:"text-red-600 hover:text-red-900 p-1",title:"Delete Product",children:(0,r.jsx)(b.A,{className:"w-4 h-4"})})]})})]},e.id))})]})})]}),"orders"===A&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Orders"}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("button",{onClick:()=>en(!ei),className:"px-3 py-1 text-sm rounded-lg flex items-center space-x-1 ".concat(ei?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,r.jsx)(y.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:ei?"Show Active":"Show Archived"})]})})]}),(0,r.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search orders...",value:X,onChange:e=>Z(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j.A,{className:"text-gray-400 w-4 h-4"}),(0,r.jsxs)("select",{value:ee,onChange:e=>et(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white",children:[(0,r.jsx)("option",{value:"ALL",children:"All Status"}),(0,r.jsx)("option",{value:"ORDER_RECEIVED",children:"Order Received"}),(0,r.jsx)("option",{value:"PENDING",children:"Pending Payment Verification"}),(0,r.jsx)("option",{value:"PAID",children:"Payment Received"}),(0,r.jsx)("option",{value:"PROCESSING",children:"Processing"}),(0,r.jsx)("option",{value:"DELIVERED",children:"Delivered"}),(0,r.jsx)("option",{value:"CANCELLED",children:"Cancelled"}),(0,r.jsx)("option",{value:"RECEIVED",children:"Device Received"}),(0,r.jsx)("option",{value:"DIAGNOSING",children:"Diagnose in Progress"}),(0,r.jsx)("option",{value:"DIAGNOSE_COMPLETE",children:"Diagnose Complete"}),(0,r.jsx)("option",{value:"QUOTE_SENT",children:"Quote Sent"}),(0,r.jsx)("option",{value:"REPAIRING",children:"Repairing"}),(0,r.jsx)("option",{value:"SHIPPED_AND_COMPLETE",children:"Shipped & Complete"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("select",{value:es,onChange:e=>er(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white",children:[(0,r.jsx)("option",{value:"createdAt",children:"Sort by Date"}),(0,r.jsx)("option",{value:"orderNumber",children:"Sort by Order #"}),(0,r.jsx)("option",{value:"total",children:"Sort by Total"}),(0,r.jsx)("option",{value:"status",children:"Sort by Status"})]}),(0,r.jsx)("button",{onClick:()=>el("asc"===ea?"desc":"asc"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"asc"===ea?"↑":"↓"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 flex items-center",children:[L.length," order",1!==L.length?"s":""," found"]})]})}),(0,r.jsx)("div",{className:"space-y-6",children:L.map(e=>{var t;return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border ".concat(e.isArchived?"border-gray-300 bg-gray-50":"border-gray-200"),children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Order ",e.orderNumber]}),e.isArchived&&(0,r.jsx)("span",{className:"text-xs bg-gray-500 text-white px-2 py-1 rounded-full",children:"Archived"})]}),(0,r.jsxs)("div",{className:"mt-1 text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[e.customerName||"Guest"," • ",e.customerEmail||"No email"]}),(0,r.jsxs)("p",{children:[e.customerPhone||"No phone"," • ",new Date(e.createdAt).toLocaleDateString()]}),e.customerAddress&&(0,r.jsx)("p",{className:"truncate max-w-md",children:e.customerAddress})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:["$",e.total.toFixed(2)]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,r.jsx)(I,{order:e,onStatusUpdate:ej}),(0,r.jsx)("button",{onClick:()=>ev(e.id,!e.isArchived),className:"p-1 rounded hover:bg-gray-100 ".concat(e.isArchived?"text-blue-600":"text-gray-400"),title:e.isArchived?"Unarchive":"Archive",children:e.isArchived?(0,r.jsx)(N.A,{className:"w-4 h-4"}):(0,r.jsx)(y.A,{className:"w-4 h-4"})})]})]})]})}),(0,r.jsx)("div",{className:"px-6 py-3 border-b border-gray-200 bg-yellow-50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(v.A,{className:"w-4 h-4 text-yellow-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-yellow-800",children:"Internal Notes:"}),ed===e.id?(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"text",value:eo,onChange:e=>ex(e.target.value),className:"flex-1 px-2 py-1 text-sm border border-yellow-300 rounded focus:outline-none focus:ring-1 focus:ring-yellow-500 text-gray-900",placeholder:"Add internal notes..."}),(0,r.jsx)("button",{onClick:()=>eN(e.id),className:"text-xs bg-yellow-600 text-white px-2 py-1 rounded hover:bg-yellow-700",children:"Save"}),(0,r.jsx)("button",{onClick:()=>{ec(null),ex("")},className:"text-xs bg-gray-500 text-white px-2 py-1 rounded hover:bg-gray-600",children:"Cancel"})]}):(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm text-yellow-700 flex-1",children:e.internalNotes||"No notes"}),(0,r.jsx)("button",{onClick:()=>{ec(e.id),ex(e.internalNotes||"")},className:"text-xs text-yellow-600 hover:text-yellow-800",children:e.internalNotes?"Edit":"Add"})]})]})}),(0,r.jsx)("div",{className:"px-6 py-3 border-b border-gray-200 bg-green-50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(d.A,{className:"w-4 h-4 text-green-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Tracking Number:"}),em===e.id?(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"text",value:eh,onChange:e=>ep(e.target.value),className:"flex-1 px-2 py-1 text-sm border border-green-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500 text-gray-900",placeholder:"Enter tracking number..."}),(0,r.jsx)("button",{onClick:()=>ew(e.id),className:"text-xs bg-green-600 text-white px-2 py-1 rounded hover:bg-green-700",children:"Save"}),(0,r.jsx)("button",{onClick:()=>{eu(null),ep("")},className:"text-xs bg-gray-500 text-white px-2 py-1 rounded hover:bg-gray-600",children:"Cancel"})]}):(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm text-green-700 flex-1",children:e.trackingNumber||"No tracking number"}),(0,r.jsx)("button",{onClick:()=>{eu(e.id),ep(e.trackingNumber||"")},className:"text-xs text-green-600 hover:text-green-800",children:e.trackingNumber?"Edit":"Add"})]})]})}),((null==(t=e.items)?void 0:t.some(e=>"mail-in-service"===e.product.id))||!1)&&(0,r.jsx)("div",{className:"px-6 py-3 border-b border-gray-200 bg-cyan-50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(w.A,{className:"w-4 h-4 text-cyan-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-cyan-800",children:"Repair Quote:"}),eg===e.id?(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("textarea",{value:ey,onChange:e=>ef(e.target.value),className:"flex-1 px-2 py-1 text-sm border border-cyan-300 rounded focus:outline-none focus:ring-1 focus:ring-cyan-500 text-gray-900",placeholder:"Enter repair quote details, including cost and description...",rows:3}),(0,r.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,r.jsx)("button",{onClick:()=>ek(e.id),className:"text-xs bg-cyan-600 text-white px-2 py-1 rounded hover:bg-cyan-700",children:"Save"}),(0,r.jsx)("button",{onClick:()=>eb(null),className:"text-xs bg-gray-500 text-white px-2 py-1 rounded hover:bg-gray-600",children:"Cancel"})]})]}):(0,r.jsxs)("div",{className:"flex-1 flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm text-cyan-700 flex-1",children:e.repairQuote||"No repair quote"}),(0,r.jsx)("button",{onClick:()=>{eb(e.id),ef(e.repairQuote||"")},className:"text-xs text-cyan-600 hover:text-cyan-800",children:e.repairQuote?"Edit":"Add"})]})]})}),(()=>{var t;let s=(null==(t=e.items)?void 0:t.some(e=>"mail-in-service"===e.product.id))||!1;return"PAID"===e.status&&s&&(0,r.jsxs)("div",{className:"px-6 py-3 border-b border-gray-200 bg-blue-50",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)(k.A,{className:"w-4 h-4 text-blue-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Ship-to Instructions:"})]}),(0,r.jsxs)("div",{className:"bg-blue-100 rounded-lg p-3 text-sm",children:[(0,r.jsx)("p",{className:"font-semibold text-blue-900 mb-1",children:"Ship your device to:"}),(0,r.jsxs)("div",{className:"text-blue-800",children:[(0,r.jsx)("p",{children:"JB Inverters"}),(0,r.jsx)("p",{children:"5330 W Palmer Dr"}),(0,r.jsx)("p",{children:"Banning, CA 92220"})]}),(0,r.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"Include detailed problem description and your contact information."})]})]})})(),e.serialNumbers.length>0&&(0,r.jsxs)("div",{className:"px-6 py-3 border-b border-gray-200 bg-blue-50",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Assigned Serial Numbers:"}),(0,r.jsx)("div",{className:"space-y-1",children:e.serialNumbers.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-blue-900",children:e.serialNumber}),(0,r.jsxs)("span",{className:"text-blue-600 ml-2",children:["(",e.product.name,")"]}),e.notes&&(0,r.jsxs)("span",{className:"text-blue-500 ml-2",children:["- ",e.notes]})]}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("SOLD"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status})]},e.id))})]}),(0,r.jsxs)("div",{className:"px-6 py-4",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:["Items (",e.items.length,")"]}),(0,r.jsx)("div",{className:"space-y-3",children:e.items.map(t=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:t.product.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Quantity: ",t.quantity," \xd7 $",t.price.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",(t.quantity*t.price).toFixed(2)]}),!e.isArchived&&(0,r.jsx)("button",{onClick:()=>{K({orderId:e.id,orderNumber:e.orderNumber,productId:t.productId,productName:t.product.name,quantity:t.quantity}),W(!0)},className:"text-xs bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700",children:"Assign Serial #"})]})]},t.id))})]})]},e.id)})})]})]})]})]}),(0,r.jsx)(C,{isOpen:J,onClose:()=>G(!1),onProductAdded:()=>{ej()}}),(0,r.jsx)(O,{isOpen:V,onClose:()=>{B(!1),M(null)},onProductUpdated:()=>{ej(),B(!1),M(null)},product:Q}),(0,r.jsx)(R,{isOpen:z,onClose:()=>{$(!1),M(null)},productId:(null==Q?void 0:Q.id)||"",productName:(null==Q?void 0:Q.name)||""}),(0,r.jsx)(F,{isOpen:H,onClose:()=>{W(!1),K(null)},orderId:(null==Y?void 0:Y.orderId)||"",orderNumber:(null==Y?void 0:Y.orderNumber)||"",productId:(null==Y?void 0:Y.productId)||"",productName:(null==Y?void 0:Y.productName)||"",quantity:(null==Y?void 0:Y.quantity)||0,onSerialNumbersAssigned:ej})]})})}},5902:(e,t,s)=>{Promise.resolve().then(s.bind(s,1873))}},e=>{e.O(0,[489,921,441,255,120],()=>e(e.s=5902)),_N_E=e.O()}]);